<tcode-information-bar></tcode-information-bar>
<tcode-navbar>
  <div class="logo-section">
    <img src="../assets/img/logo.png" alt="logo">
  </div>
  <div class="action-section">
    <img src="../assets/img/search.svg" class="search" alt="search">
    <img
      src="../assets/img/user.svg"
      class="profile cursor-pointer" alt="profile"
      [matMenuTriggerFor]="authMenu"
      *ngIf="isLoggedIn | async"
    >
    <img
      src="../assets/img/user.svg"
      class="profile cursor-pointer" alt="profile"
      (click)="handleAuthAction()"
      matTooltip="Login"
      *ngIf="!(isLoggedIn | async)"
      >
    <img src="../assets/img/heart.svg" class="wishlist" alt="wishlist">
    <mat-icon [matBadge]="cartCount$ | async" matBadgeColor="warn" class="cart cursor-pointer" matBadgeSize="small" (click)="showCart = true">local_mall</mat-icon>
  </div>
</tcode-navbar>
<router-outlet></router-outlet>
<tcode-footer></tcode-footer>

<mat-menu #authMenu="matMenu" class="auth-menu" xPosition="after">
  <button mat-menu-item>Account Info</button>
  <button mat-menu-item>Orders</button>
  <button mat-menu-item (click)="logOut()">Log out</button>
</mat-menu>

<div class="cart-wrapper" *ngIf="showCart">
  <div class="header flex">
    <mat-icon class="cursor-pointer" (click)="showCart = false">close</mat-icon>
    <h2 class="title">Shopping Cart</h2>
    <p><span class="count bold">{{ cartCount$ | async }} </span> item(s)</p>
  </div>
  <div class="content mt-1 flex flex-col">
    <div class="cartItem flex" *ngFor="let item of (cartItems$ | async)">
      <div class="image">
        <img [src]="item?.item?.images[0]?.image" alt="product-image" height="98" width="128" class="cursor-pointer" (click)="gotoProductPage(item.item)">
      </div>
      <div class="price">
        <p class="item-name">{{ item?.item?.title }}</p>
        <p class="item-price">{{ item?.quantity }} x {{ item?.item?.price.value | currency: (item?.item?.price?.currency): 'code' }}</p>
      </div>
      <mat-icon class="cursor-pointer" (click)="removeFromCart(item.item)">delete_outline</mat-icon>
    </div>
  </div>
  <div class="total">
    <p class="cart-total">Total: {{ (cartAmount$ | async) | currency: 'NGN': 'code' }}</p>
    <div class="button">
      <tcode-button type="normal" (click)="navigateToCheckout()">Proceed to checkout</tcode-button>
    </div>
  </div>
</div>
